<!DOCTYPE html>
<script src="wasm_exec.js"></script>
<script>
    // Load the WASM file
    const go = new Go();
    WebAssembly.instantiateStreaming(fetch("gophersand.wasm"), go.importObject).then(result => {
        go.run(result.instance);
    });

    // Channel parent messages into the WASM game
    window.addEventListener("message", (e) => {
        const data = e.data;
        if (!data || data.type !== "site-event") return;

        if (window.sendToGame) {
            console.log('Sending to game', data.payload);
            window.sendToGame(String(data.payload || ""));
        }
    });
</script>